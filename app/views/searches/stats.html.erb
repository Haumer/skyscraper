<div class="tab">
  <button class="tablinks" onclick="openCity(event, 'Overall')">Overall</button>
  <button class="tablinks" onclick="openCity(event, 'Recruiters')">Recruiters</button>
  <button class="tablinks" onclick="openCity(event, 'All-Companies')">Companies</button>
</div>
<script>
  Chartkick.options[:content_for] = :charts_js
</script>

<div id="Overall" class="tabcontent text-center">
  <%= line_chart Search.group_by_day(:created_at).count, xtitle: "Days", ytitle: "Searches" %>
  <%= line_chart Job.group_by_day(:created_at).count, xtitle: "Days", ytitle: "Jobs Scraped" %>
  <%= line_chart Website.group(:jobs).count %>
</div>

<div id="Recruiters" class="tabcontent">

</div>

<div id="All-Companies" class="tabcontent">
  <%= line_chart @firms.map { |firm|
    {name: firm.firm_name, data: firm.gr.count }
}.first(10)  %>
</div>

<script>
function openCity(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
}
</script>
